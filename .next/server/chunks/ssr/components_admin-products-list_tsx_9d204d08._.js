module.exports=[74116,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(71987),f=a.i(70106);let g=(0,f.default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var h=a.i(87532);let i=(0,f.default)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);var j=a.i(81560),k=a.i(15618),l=a.i(40695),m=a.i(3130),n=a.i(5522),o=a.i(77687),p=a.i(5050),q=(0,p.createServerReference)("409cddbb14d4b70d5a89d75fa26bb4540776c05fcc",p.callServer,void 0,p.findSourceMapURL,"deleteProduct"),r=a.i(65733),s=a.i(17171),t=a.i(46893),u=a.i(87682),v=(0,p.createServerReference)("40c75e47406cb1f4a7be600a05451db9035e5c428c",p.callServer,void 0,p.findSourceMapURL,"addProduct"),w=(0,p.createServerReference)("609bdeec0dbdb6e062313dcb5efafb104904b81202",p.callServer,void 0,p.findSourceMapURL,"updateProduct"),x=a.i(33508);let y=(0,f.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function z({product:a,onSuccess:d}){let[e,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(()=>a?.images&&Array.isArray(a.images)&&a.images.length>0?a.images.filter(a=>a&&""!==a.trim()):a?.image_url&&""!==a.image_url.trim()?[a.image_url]:[]),[i,j]=(0,c.useState)(""),[k,m]=(0,c.useState)(!1),[p,q]=(0,c.useState)([]),[r,z]=(0,c.useState)(a?.category_id?.toString()||""),{toast:A}=(0,o.useToast)();function B(){i.trim()&&(h([...g,i.trim()]),j(""))}async function C(a){let b=a.target.files;if(b&&0!==b.length){m(!0);try{for(let a of Array.from(b)){if(a.size>5242880){A({title:"Warning",description:`${a.name} is too large. Please use images under 5MB or provide a URL instead.`,variant:"destructive"});continue}let b=new FileReader;b.onload=a=>{a.target?.result&&h(b=>[...b,a.target.result])},b.readAsDataURL(a)}A({title:"Images added",description:`${b.length} image(s) added successfully.`})}catch(a){A({title:"Error",description:"Failed to upload images. Please try again.",variant:"destructive"})}finally{m(!1),a.target.value=""}}}async function D(b){b.preventDefault(),f(!0);let c=new FormData(b.currentTarget),e={name:c.get("name"),description:c.get("description"),price:c.get("price"),category_id:Number.parseInt(r),image_url:g[0]||"",images:g.length>0?g:[],metal_purity:c.get("metal_purity"),design_number:c.get("design_number")},h=a?await w(a.id,e):await v(e);f(!1),h.success?(A({title:a?"Product updated":"Product added",description:a?"Product has been updated successfully.":"Product has been added successfully."}),d()):A({title:"Error",description:h.error||"Failed to save product",variant:"destructive"})}return(0,c.useEffect)(()=>{!async function(){try{let b=await fetch("/api/categories"),c=await b.json();q(c),!a&&c.length>0&&z(c[0].id.toString())}catch(a){console.error("Failed to fetch categories:",a)}}()},[a]),(0,b.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"name",children:"Product Name *"}),(0,b.jsx)(n.Input,{id:"name",name:"name",defaultValue:a?.name,required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"description",children:"Description *"}),(0,b.jsx)(t.Textarea,{id:"description",name:"description",defaultValue:a?.description,required:!0,rows:4})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"price",children:"Price (â‚¹) *"}),(0,b.jsx)(n.Input,{id:"price",name:"price",type:"number",step:"0.01",defaultValue:a?.price,required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"category_id",children:"Category *"}),(0,b.jsxs)(u.Select,{name:"category_id",value:r,onValueChange:z,children:[(0,b.jsx)(u.SelectTrigger,{children:(0,b.jsx)(u.SelectValue,{placeholder:"Select category"})}),(0,b.jsx)(u.SelectContent,{children:p.map(a=>(0,b.jsx)(u.SelectItem,{value:a.id.toString(),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{children:"Product Images"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{className:"text-sm text-muted-foreground",children:"Add from URL"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(n.Input,{type:"url",placeholder:"https://example.com/image.jpg",value:i,onChange:a=>j(a.target.value),onKeyPress:a=>{"Enter"===a.key&&(a.preventDefault(),B())}}),(0,b.jsx)(l.Button,{type:"button",onClick:B,variant:"secondary",children:"Add"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{className:"text-sm text-muted-foreground",children:"Upload from Device"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(n.Input,{type:"file",accept:"image/*",multiple:!0,onChange:C,disabled:k,className:"cursor-pointer",id:"file-upload"}),(0,b.jsx)(s.Label,{htmlFor:"file-upload",className:"cursor-pointer",children:(0,b.jsx)(l.Button,{type:"button",variant:"secondary",disabled:k,asChild:!0,children:(0,b.jsxs)("span",{children:[(0,b.jsx)(y,{className:"h-4 w-4 mr-2"}),k?"Uploading...":"Browse"]})})})]})]})]}),g.length>0&&(0,b.jsx)("div",{className:"grid grid-cols-3 gap-3",children:g.map((a,c)=>(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)("img",{src:a||"/placeholder.svg",alt:`Product ${c+1}`,className:"h-24 w-full object-cover rounded border"}),(0,b.jsx)("button",{type:"button",onClick:()=>{h(g.filter((a,b)=>b!==c))},className:"absolute top-1 right-1 bg-destructive text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,b.jsx)(x.X,{className:"h-3 w-3"})}),0===c&&(0,b.jsx)("span",{className:"absolute bottom-1 left-1 bg-primary text-white text-xs px-2 py-0.5 rounded",children:"Main"})]},c))}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Add multiple images via URL or upload from your device (max 5MB per image). First image will be the main product image."})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"metal_purity",children:"Metal Purity"}),(0,b.jsx)(n.Input,{id:"metal_purity",name:"metal_purity",placeholder:"925 Sterling",defaultValue:a?.metal_purity})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"design_number",children:"Design Number"}),(0,b.jsx)(n.Input,{id:"design_number",name:"design_number",placeholder:"DN-001",defaultValue:a?.design_number})]})]}),(0,b.jsx)(l.Button,{type:"submit",disabled:e,className:"w-full",children:e?"Saving...":a?"Update Product":"Add Product"})]})}function A({products:a}){let[f,p]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(null),{toast:D}=(0,o.useToast)(),E=(0,c.useMemo)(()=>a.filter(a=>{let b=!f||a.name.toLowerCase().includes(f.toLowerCase())||a.category_name.toLowerCase().includes(f.toLowerCase()),c=!s||a.design_number&&a.design_number.toLowerCase().includes(s.toLowerCase()),d=Number.parseFloat(a.price),e=!u||d>=Number.parseFloat(u),g=!w||d<=Number.parseFloat(w);return b&&c&&e&&g}),[a,f,s,u,w]),F=async(a,b)=>{if(!confirm(`Are you sure you want to delete "${b}"?`))return;let c=await q(a);c.success?(D({title:"Product deleted",description:`${b} has been deleted successfully.`}),window.location.reload()):D({title:"Error",description:c.error||"Failed to delete product",variant:"destructive"})};return(0,b.jsx)("div",{className:"min-h-screen bg-background",children:(0,b.jsxs)("div",{className:"mx-auto max-w-7xl px-4 py-8",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)(d.default,{href:"/admin",children:(0,b.jsxs)(l.Button,{variant:"ghost",size:"sm",className:"mb-4",children:[(0,b.jsx)(g,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"All Products"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage your product catalog"})]}),(0,b.jsxs)(r.Dialog,{open:y,onOpenChange:A,children:[(0,b.jsx)(r.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(l.Button,{children:[(0,b.jsx)(k.Plus,{className:"mr-2 h-4 w-4"}),"Add Product"]})}),(0,b.jsxs)(r.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(r.DialogHeader,{children:[(0,b.jsx)(r.DialogTitle,{children:"Add New Product"}),(0,b.jsx)(r.DialogDescription,{children:"Create a new product in your catalog"})]}),(0,b.jsx)(z,{onSuccess:()=>A(!1)})]})]})]})]}),(0,b.jsxs)(m.Card,{className:"p-6 mb-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(h.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(n.Input,{type:"text",placeholder:"Search by name or category...",value:f,onChange:a=>p(a.target.value),className:"pl-10"})]}),(0,b.jsx)("div",{children:(0,b.jsx)(n.Input,{type:"text",placeholder:"Design Number",value:s,onChange:a=>t(a.target.value)})}),(0,b.jsx)("div",{children:(0,b.jsx)(n.Input,{type:"number",placeholder:"Min Price",value:u,onChange:a=>v(a.target.value)})}),(0,b.jsx)("div",{children:(0,b.jsx)(n.Input,{type:"number",placeholder:"Max Price",value:w,onChange:a=>x(a.target.value)})})]}),(0,b.jsx)("div",{className:"flex justify-end mt-4",children:(0,b.jsx)(l.Button,{variant:"outline",onClick:()=>{p(""),t(""),v(""),x("")},children:"Clear Filters"})})]}),(0,b.jsxs)(m.Card,{className:"p-6",children:[(0,b.jsx)("div",{className:"mb-4 flex justify-between items-center",children:(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Showing ",E.length," of ",a.length," products"]})}),(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:0===E.length?(0,b.jsx)("p",{className:"col-span-full py-8 text-center text-muted-foreground",children:f||s||u||w?"No products found matching your filters":"No products yet"}):E.map(a=>{let c;return(0,b.jsxs)(m.Card,{className:"overflow-hidden",children:[(0,b.jsx)("div",{className:"relative h-48 bg-muted",children:(0,b.jsx)(e.default,{src:a.image_url||"/placeholder.svg",alt:a.name,fill:!0,className:"object-cover"})}),(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsxs)("div",{className:"mb-2",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.category_name}),(0,b.jsx)("h3",{className:"font-semibold",children:a.name}),a.design_number&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["#",a.design_number]})]}),(0,b.jsx)("div",{className:"mb-4 flex items-center justify-between",children:(0,b.jsx)("p",{className:"text-lg font-bold text-primary",children:(c=a.price,new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(Number(c)))})}),(0,b.jsxs)("div",{className:"mb-4 text-sm text-muted-foreground",children:["Total Sales: ",a.total_sales]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(r.Dialog,{children:[(0,b.jsx)(r.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(l.Button,{variant:"outline",size:"sm",className:"flex-1 bg-transparent",onClick:()=>C(a),children:[(0,b.jsx)(i,{className:"mr-2 h-4 w-4"}),"Edit"]})}),(0,b.jsxs)(r.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(r.DialogHeader,{children:[(0,b.jsx)(r.DialogTitle,{children:"Edit Product"}),(0,b.jsx)(r.DialogDescription,{children:"Update product information"})]}),(0,b.jsx)(z,{product:B?{...B,images:B.images||(B.image_url?[B.image_url]:[])}:null,onSuccess:()=>C(null)})]})]}),(0,b.jsx)(l.Button,{variant:"outline",size:"sm",onClick:()=>F(a.id,a.name),children:(0,b.jsx)(j.Trash2,{className:"h-4 w-4"})})]})]})]},a.id)})})]})]})})}a.s(["AdminProductsList",()=>A],74116)}];

//# sourceMappingURL=components_admin-products-list_tsx_9d204d08._.js.map