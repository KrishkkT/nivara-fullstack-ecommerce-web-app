module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},5050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(20611),g=a.r(1722),h=a.r(38783)},83497,a=>{"use strict";let b=(0,a.i(70106).default)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);a.s(["Package",()=>b],83497)},30845,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(40695),e=a.i(5050),f=(0,e.createServerReference)("4068bf0181f24a199e2d852075c25992cf1639aea9",e.callServer,void 0,e.findSourceMapURL,"cancelOrder"),g=(0,e.createServerReference)("401afdf693e644ce4f0761bfd0af817d46732dc380",e.callServer,void 0,e.findSourceMapURL,"cancelOrder"),h=a.i(50944),i=a.i(77687);function j({orderId:a,isAdmin:e=!1}){let[j,k]=(0,c.useState)(!1),l=(0,h.useRouter)(),{toast:m}=(0,i.useToast)();async function n(){if(!confirm("Are you sure you want to cancel this order?"))return;k(!0);let b=e?await g(a):await f(a);k(!1),b.error?m({title:"Error",description:b.error,variant:"destructive"}):(m({title:"Order Cancelled",description:"Your order has been cancelled successfully. Refund will be processed within 5-7 working days."}),l.refresh())}return(0,b.jsx)(d.Button,{variant:"destructive",size:"sm",onClick:n,disabled:j,className:"w-full",children:j?"Cancelling...":"Cancel Order"})}a.s(["CancelOrderButton",()=>j],30845)},67453,a=>{"use strict";let b=(0,a.i(70106).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);a.s(["CheckCircle2",()=>b],67453)},97848,a=>{"use strict";var b=a.i(5050),c=(0,b.createServerReference)("00418ce438cb53ce0d5731b9ed91863489d3d34d38",b.callServer,void 0,b.findSourceMapURL,"getRazorpayPublicKey");a.s(["getRazorpayPublicKey",()=>c])},10051,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(71987),f=a.i(38246),g=a.i(40695),h=a.i(97895),i=a.i(67453),j=a.i(70106);let k=(0,j.default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var l=a.i(83497);let m=(0,j.default)("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);var n=a.i(97848),o=a.i(30845);function p({order:a,items:j}){let p=(0,d.useRouter)(),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(!1);async function y(){if(!u)return void alert("Payment system is still loading. Please wait a moment and try again.");if(w)return void alert("Payment system failed to load. Please refresh the page and try again.");if(!s)return void alert("Payment system is loading. Please try again in a moment.");if(!window.Razorpay)return void alert("Payment gateway is not ready. Please refresh the page and try again.");r(!0);try{let b=await fetch("/api/razorpay/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number.parseFloat(a.total_amount),orderId:a.id})}),c=await b.json();if(!b.ok)throw Error(c.error||"Failed to create payment order");let d={key:s,amount:c.amount,currency:c.currency,name:"NIVARA",description:`Order ${a.order_number}`,order_id:c.id,handler:async b=>{try{let c=await fetch("/api/razorpay/verify-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_order_id:b.razorpay_order_id,razorpay_payment_id:b.razorpay_payment_id,razorpay_signature:b.razorpay_signature,orderId:a.id})});await c.json(),c.ok?(alert("Payment successful! Your order is being processed."),p.push("/orders"),p.refresh()):alert("Payment verification failed. Please contact support.")}catch(a){alert("Payment verification failed. Please contact support.")}finally{r(!1),document.body.style.overflow=""}},modal:{ondismiss:()=>{r(!1),document.body.style.overflow=""}},prefill:{name:a.shipping_address?.name||"",email:a.shipping_address?.email||""},theme:{color:"#B29789"}},e=new window.Razorpay(d);e.on("payment.failed",a=>{alert(`Payment failed: ${a.error.description}`),r(!1),document.body.style.overflow=""}),e.open()}catch(a){alert(a.message||"Payment failed. Please try again."),r(!1)}}(0,c.useEffect)(()=>{let a=document.createElement("script");return a.src="https://checkout.razorpay.com/v1/checkout.js",a.async=!0,a.onload=()=>{v(!0)},a.onerror=()=>{x(!0)},document.body.appendChild(a),(0,n.getRazorpayPublicKey)().then(a=>t(a)),()=>{document.body.contains(a)&&document.body.removeChild(a)}},[]);let z=a.shipping_address||{},A={pending:k,processing:l.Package,shipped:m,delivered:i.CheckCircle2,cancelled:k}[a.status]||k,B="cancelled"===a.status,C=!B&&"razorpay"===a.payment_type&&"awaiting_payment"===a.payment_status,D="shipped"===a.status||"delivered"===a.status;return(0,b.jsx)("div",{className:"container px-4 py-12",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-serif tracking-tight mb-2",children:"Order Details"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Order #",a.order_number]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Placed on"," ",new Date(a.created_at).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(A,{className:"h-5 w-5 text-primary"}),(0,b.jsx)("span",{className:"font-medium capitalize",children:a.status})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("span",{className:"text-xs px-3 py-1 rounded-full bg-blue-100 text-blue-800",children:"Online Payment"}),!B&&"paid"!==a.payment_status&&(0,b.jsx)("span",{className:"text-xs px-3 py-1 rounded-full bg-yellow-100 text-yellow-800",children:"awaiting_payment"===a.payment_status?"Pending Payment":a.payment_status}),"paid"===a.payment_status&&(0,b.jsx)("span",{className:"text-xs px-3 py-1 rounded-full bg-green-100 text-green-800",children:"Paid"})]})]})]}),B&&(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,b.jsxs)("p",{className:"text-sm",children:[(0,b.jsx)("strong",{children:"Your order has been cancelled."})," Refund will be processed within 5-7 working days."]})}),C&&(0,b.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,b.jsx)("p",{className:"text-sm mb-3",children:"Complete your payment to process this order"}),(0,b.jsx)(g.Button,{onClick:y,disabled:q||!s||!u||w,children:q?"Processing...":"Pay Now"}),(w||!u)&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:w?"Payment system failed to load.":"Payment system is loading..."})]}),!B&&!D&&!C&&(0,b.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,b.jsxs)("p",{className:"text-sm",children:[(0,b.jsx)("strong",{children:"Shipping Information:"})," You will receive a shipping confirmation email at your registered email address once your order is shipped."]})}),!B&&("pending"===a.status||"processing"===a.status)&&(0,b.jsx)("div",{className:"bg-card border rounded-lg p-4",children:(0,b.jsx)(o.CancelOrderButton,{orderId:a.id})}),(0,b.jsxs)("div",{className:"bg-card border rounded-lg p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Items"}),(0,b.jsx)("div",{className:"space-y-4",children:j.map(a=>(0,b.jsxs)("div",{className:"flex gap-4 pb-4 border-b last:border-0 last:pb-0",children:[(0,b.jsx)(f.default,{href:`/products/${a.slug}`,className:"flex-shrink-0",children:(0,b.jsx)("div",{className:"relative w-20 h-20 rounded-md overflow-hidden",children:(0,b.jsx)(e.default,{src:a.image_url||"/placeholder.svg",alt:a.product_name,fill:!0,className:"object-cover"})})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(f.default,{href:`/products/${a.slug}`,children:(0,b.jsx)("h3",{className:"font-medium hover:text-primary transition-colors",children:a.product_name})}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Quantity: ",a.quantity]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-semibold",children:(0,h.formatPrice)(Number.parseFloat(a.product_price))}),a.quantity>1&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,h.formatPrice)(Number.parseFloat(a.product_price)*a.quantity)," total"]})]})]},a.id))}),(0,b.jsxs)("div",{className:"pt-4 mt-4 border-t space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Subtotal"}),(0,b.jsx)("span",{children:(0,h.formatPrice)(Number.parseFloat(a.total_amount))})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Shipping"}),(0,b.jsx)("span",{className:"text-green-600",children:"FREE"})]}),(0,b.jsxs)("div",{className:"flex justify-between text-lg font-semibold pt-2",children:[(0,b.jsx)("span",{children:"Total"}),(0,b.jsx)("span",{children:(0,h.formatPrice)(Number.parseFloat(a.total_amount))})]})]})]}),z&&Object.keys(z).length>0&&(0,b.jsxs)("div",{className:"bg-card border rounded-lg p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Shipping Address"}),(0,b.jsxs)("div",{className:"text-sm space-y-1",children:[(0,b.jsx)("p",{children:z.address_line1||""}),z.address_line2&&(0,b.jsx)("p",{children:z.address_line2}),(0,b.jsxs)("p",{children:[z.city||"",", ",z.state||""," ",z.postal_code||""]}),(0,b.jsx)("p",{children:z.country||""})]})]})]})})}a.s(["OrderDetails",()=>p],10051)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__248b39d9._.js.map