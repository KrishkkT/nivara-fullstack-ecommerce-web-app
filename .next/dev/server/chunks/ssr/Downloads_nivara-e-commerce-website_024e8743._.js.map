{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/Downloads/nivara-e-commerce-website/lib/db.ts"],"sourcesContent":["import { neon } from \"@neondatabase/serverless\"\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL environment variable is not set\")\n}\n\nexport const sql = neon(process.env.DATABASE_URL)\n"],"names":[],"mappings":";;;;AAAA;;AAEA,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;IAC7B,MAAM,IAAI,MAAM;AAClB;AAEO,MAAM,MAAM,IAAA,iNAAI,EAAC,QAAQ,GAAG,CAAC,YAAY"}},
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/Downloads/nivara-e-commerce-website/lib/auth.ts"],"sourcesContent":["import { sql } from \"./db\"\n\nexport interface User {\n  id: number\n  email: string\n  full_name: string\n  phone?: string\n  role: string\n  created_at: Date\n}\n\n// Use Web Crypto API instead of bcryptjs for better compatibility in edge environments\nexport async function hashPassword(password: string): Promise<string> {\n  const encoder = new TextEncoder()\n  const data = encoder.encode(password)\n  const hashBuffer = await crypto.subtle.digest(\"SHA-256\", data)\n  const hashArray = Array.from(new Uint8Array(hashBuffer))\n  const hashHex = hashArray.map((b) => b.toString(16).padStart(2, \"0\")).join(\"\")\n  return hashHex\n}\n\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\n  const passwordHash = await hashPassword(password)\n  return passwordHash === hash\n}\n\nexport async function createUser(email: string, password: string, fullName: string, phone?: string): Promise<User> {\n  const passwordHash = await hashPassword(password)\n\n  const result = await sql`\n    INSERT INTO users (email, password_hash, full_name, phone)\n    VALUES (${email}, ${passwordHash}, ${fullName}, ${phone})\n    RETURNING id, email, full_name, phone, role, created_at\n  `\n\n  return result[0] as User\n}\n\nexport async function getUserByEmail(email: string): Promise<(User & { password_hash: string }) | null> {\n  const result = await sql`\n    SELECT id, email, password_hash, full_name, phone, role, created_at\n    FROM users\n    WHERE email = ${email}\n  `\n\n  return (result[0] as User & { password_hash: string }) || null\n}\n\nexport async function getUserById(id: number): Promise<User | null> {\n  const result = await sql`\n    SELECT id, email, full_name, phone, role, created_at\n    FROM users\n    WHERE id = ${id}\n  `\n\n  return (result[0] as User) || null\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAYO,eAAe,aAAa,QAAgB;IACjD,MAAM,UAAU,IAAI;IACpB,MAAM,OAAO,QAAQ,MAAM,CAAC;IAC5B,MAAM,aAAa,MAAM,OAAO,MAAM,CAAC,MAAM,CAAC,WAAW;IACzD,MAAM,YAAY,MAAM,IAAI,CAAC,IAAI,WAAW;IAC5C,MAAM,UAAU,UAAU,GAAG,CAAC,CAAC,IAAM,EAAE,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,MAAM,IAAI,CAAC;IAC3E,OAAO;AACT;AAEO,eAAe,eAAe,QAAgB,EAAE,IAAY;IACjE,MAAM,eAAe,MAAM,aAAa;IACxC,OAAO,iBAAiB;AAC1B;AAEO,eAAe,WAAW,KAAa,EAAE,QAAgB,EAAE,QAAgB,EAAE,KAAc;IAChG,MAAM,eAAe,MAAM,aAAa;IAExC,MAAM,SAAS,MAAM,mKAAG,CAAC;;YAEf,EAAE,MAAM,EAAE,EAAE,aAAa,EAAE,EAAE,SAAS,EAAE,EAAE,MAAM;;EAE1D,CAAC;IAED,OAAO,MAAM,CAAC,EAAE;AAClB;AAEO,eAAe,eAAe,KAAa;IAChD,MAAM,SAAS,MAAM,mKAAG,CAAC;;;kBAGT,EAAE,MAAM;EACxB,CAAC;IAED,OAAO,AAAC,MAAM,CAAC,EAAE,IAAyC;AAC5D;AAEO,eAAe,YAAY,EAAU;IAC1C,MAAM,SAAS,MAAM,mKAAG,CAAC;;;eAGZ,EAAE,GAAG;EAClB,CAAC;IAED,OAAO,AAAC,MAAM,CAAC,EAAE,IAAa;AAChC"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/Downloads/nivara-e-commerce-website/app/actions/auth.ts"],"sourcesContent":["\"use server\"\n\nimport { cookies } from \"next/headers\"\nimport { createUser, getUserByEmail, verifyPassword } from \"@/lib/auth\"\nimport { createSession } from \"@/lib/session\"\nimport { redirect } from \"next/navigation\"\n\nexport async function signUp(formData: FormData) {\n  const email = formData.get(\"email\") as string\n  const password = formData.get(\"password\") as string\n  const fullName = formData.get(\"fullName\") as string\n  const phone = formData.get(\"phone\") as string | undefined\n\n  // Validation\n  if (!email || !password || !fullName) {\n    return { error: \"All fields are required\" }\n  }\n\n  if (password.length < 8) {\n    return { error: \"Password must be at least 8 characters\" }\n  }\n\n  try {\n    // Check if user already exists\n    const existingUser = await getUserByEmail(email)\n    if (existingUser) {\n      return { error: \"Email already registered\" }\n    }\n\n    // Create user\n    const user = await createUser(email, password, fullName, phone)\n\n    // Create session\n    const token = await createSession({\n      userId: user.id,\n      email: user.email,\n      role: user.role,\n    })\n\n    const cookieStore = await cookies()\n    cookieStore.set(\"session\", token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"lax\",\n      maxAge: 60 * 60 * 24 * 7, // 7 days\n    })\n\n    return { success: true }\n  } catch (error) {\n    console.error(\"[v0] Sign up error:\", error)\n    return { error: \"Failed to create account\" }\n  }\n}\n\nexport async function signIn(formData: FormData) {\n  const email = formData.get(\"email\") as string\n  const password = formData.get(\"password\") as string\n\n  if (!email || !password) {\n    return { error: \"Email and password are required\" }\n  }\n\n  try {\n    const user = await getUserByEmail(email)\n\n    if (!user) {\n      return { error: \"Invalid email or password\" }\n    }\n\n    const isValidPassword = await verifyPassword(password, user.password_hash)\n\n    if (!isValidPassword) {\n      return { error: \"Invalid email or password\" }\n    }\n\n    // Create session\n    const token = await createSession({\n      userId: user.id,\n      email: user.email,\n      role: user.role,\n    })\n\n    const cookieStore = await cookies()\n    cookieStore.set(\"session\", token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"lax\",\n      maxAge: 60 * 60 * 24 * 7, // 7 days\n    })\n\n    return { success: true }\n  } catch (error) {\n    console.error(\"[v0] Sign in error:\", error)\n    return { error: \"Failed to sign in\" }\n  }\n}\n\nexport async function signOut() {\n  const cookieStore = await cookies()\n  cookieStore.delete(\"session\")\n  redirect(\"/\")\n}\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AACA;AACA;AAAA;;;;;;;AAEO,eAAe,OAAO,QAAkB;IAC7C,MAAM,QAAQ,SAAS,GAAG,CAAC;IAC3B,MAAM,WAAW,SAAS,GAAG,CAAC;IAC9B,MAAM,WAAW,SAAS,GAAG,CAAC;IAC9B,MAAM,QAAQ,SAAS,GAAG,CAAC;IAE3B,aAAa;IACb,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU;QACpC,OAAO;YAAE,OAAO;QAA0B;IAC5C;IAEA,IAAI,SAAS,MAAM,GAAG,GAAG;QACvB,OAAO;YAAE,OAAO;QAAyC;IAC3D;IAEA,IAAI;QACF,+BAA+B;QAC/B,MAAM,eAAe,MAAM,IAAA,gLAAc,EAAC;QAC1C,IAAI,cAAc;YAChB,OAAO;gBAAE,OAAO;YAA2B;QAC7C;QAEA,cAAc;QACd,MAAM,OAAO,MAAM,IAAA,4KAAU,EAAC,OAAO,UAAU,UAAU;QAEzD,iBAAiB;QACjB,MAAM,QAAQ,MAAM,IAAA,kLAAa,EAAC;YAChC,QAAQ,KAAK,EAAE;YACf,OAAO,KAAK,KAAK;YACjB,MAAM,KAAK,IAAI;QACjB;QAEA,MAAM,cAAc,MAAM,IAAA,6LAAO;QACjC,YAAY,GAAG,CAAC,WAAW,OAAO;YAChC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK,KAAK;QACzB;QAEA,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO;YAAE,OAAO;QAA2B;IAC7C;AACF;AAEO,eAAe,OAAO,QAAkB;IAC7C,MAAM,QAAQ,SAAS,GAAG,CAAC;IAC3B,MAAM,WAAW,SAAS,GAAG,CAAC;IAE9B,IAAI,CAAC,SAAS,CAAC,UAAU;QACvB,OAAO;YAAE,OAAO;QAAkC;IACpD;IAEA,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,gLAAc,EAAC;QAElC,IAAI,CAAC,MAAM;YACT,OAAO;gBAAE,OAAO;YAA4B;QAC9C;QAEA,MAAM,kBAAkB,MAAM,IAAA,gLAAc,EAAC,UAAU,KAAK,aAAa;QAEzE,IAAI,CAAC,iBAAiB;YACpB,OAAO;gBAAE,OAAO;YAA4B;QAC9C;QAEA,iBAAiB;QACjB,MAAM,QAAQ,MAAM,IAAA,kLAAa,EAAC;YAChC,QAAQ,KAAK,EAAE;YACf,OAAO,KAAK,KAAK;YACjB,MAAM,KAAK,IAAI;QACjB;QAEA,MAAM,cAAc,MAAM,IAAA,6LAAO;QACjC,YAAY,GAAG,CAAC,WAAW,OAAO;YAChC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK,KAAK;QACzB;QAEA,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO;YAAE,OAAO;QAAoB;IACtC;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,6LAAO;IACjC,YAAY,MAAM,CAAC;IACnB,IAAA,oPAAQ,EAAC;AACX;;;IA9FsB;IA+CA;IA2CA;;AA1FA,kSAAA;AA+CA,kSAAA;AA2CA,kSAAA"}},
    {"offset": {"line": 204, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/Downloads/nivara-e-commerce-website/.next-internal/server/app/login/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {signIn as '4089bee5504cd1090530a87ef4270832819bd35844'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}