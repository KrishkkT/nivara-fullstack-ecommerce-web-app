{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/Downloads/nivara-e-commerce-website/components/cancel-order-button.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const CancelOrderButton = registerClientReference(\n    function() { throw new Error(\"Attempted to call CancelOrderButton() from the server but CancelOrderButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Downloads/nivara-e-commerce-website/components/cancel-order-button.tsx <module evaluation>\",\n    \"CancelOrderButton\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,oBAAoB,IAAA,2TAAuB,EACpD;IAAa,MAAM,IAAI,MAAM;AAAkP,GAC/Q,wGACA","ignoreList":[0]}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/Downloads/nivara-e-commerce-website/components/cancel-order-button.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const CancelOrderButton = registerClientReference(\n    function() { throw new Error(\"Attempted to call CancelOrderButton() from the server but CancelOrderButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Downloads/nivara-e-commerce-website/components/cancel-order-button.tsx\",\n    \"CancelOrderButton\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,oBAAoB,IAAA,2TAAuB,EACpD;IAAa,MAAM,IAAI,MAAM;AAAkP,GAC/Q,oFACA","ignoreList":[0]}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/Downloads/nivara-e-commerce-website/app/admin/orders/%5Bid%5D/page.tsx"],"sourcesContent":["import { cookies } from \"next/headers\"\nimport { redirect } from \"next/navigation\"\nimport { verifyAuth } from \"@/lib/session\"\nimport { sql } from \"@/lib/db\"\nimport { Button } from \"@/components/ui/button\"\nimport Link from \"next/link\"\nimport Image from \"next/image\"\nimport { CancelOrderButton } from \"@/components/cancel-order-button\"\n\ninterface OrderItem {\n  id: number\n  product_id: number | null\n  quantity: number\n  product_price: string\n  product_name: string\n  image_url: string | null\n}\n\ninterface Order {\n  id: number\n  order_number: string\n  total_amount: string\n  status: string\n  payment_status: string\n  payment_type: string | null\n  razorpay_order_id: string | null\n  created_at: string\n  customer_name: string\n  customer_email: string\n  customer_phone: string | null\n  shipping_address_id: number | null\n  billing_address_id: number | null\n  shipping_address: any | null\n}\n\ninterface Address {\n  id: number\n  address_line1: string\n  address_line2: string | null\n  city: string\n  state: string\n  postal_code: string\n  country: string\n}\n\nexport default async function OrderDetailsPage({ params }: { params: Promise<{ id: string }> }) {\n  const { id } = await params\n\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"session\")?.value\n\n  if (!token) {\n    redirect(\"/login\")\n  }\n\n  const user = await verifyAuth(token)\n  if (!user || user.role !== \"admin\") {\n    redirect(\"/\")\n  }\n\n  const orderResult = await sql<Order[]>`\n    SELECT \n      o.id,\n      o.order_number,\n      o.total_amount,\n      o.status,\n      o.payment_status,\n      o.payment_type,\n      o.razorpay_order_id,\n      o.created_at,\n      o.shipping_address_id,\n      o.billing_address_id,\n      o.shipping_address,\n      u.full_name as customer_name,\n      u.email as customer_email,\n      u.phone as customer_phone\n    FROM orders o\n    JOIN users u ON o.user_id = u.id\n    WHERE o.id = ${Number.parseInt(id)}\n  `\n\n  if (!orderResult || orderResult.length === 0) {\n    redirect(\"/admin/orders\")\n  }\n\n  const order = orderResult[0]\n\n  let shippingAddress: Address | null = null\n  let billingAddress: Address | null = null\n\n  // Handle case where shipping address is stored as ID\n  if (order.shipping_address_id) {\n    const shippingResult = await sql<Address[]>`\n      SELECT id, address_line1, address_line2, city, state, postal_code, country\n      FROM addresses\n      WHERE id = ${order.shipping_address_id}\n    `\n    shippingAddress = shippingResult?.[0] || null\n  }\n  // Handle case where shipping address is stored as JSON\n  else if (order.shipping_address) {\n    shippingAddress = {\n      id: 0,\n      address_line1: order.shipping_address.address_line1 || '',\n      address_line2: order.shipping_address.address_line2 || null,\n      city: order.shipping_address.city || '',\n      state: order.shipping_address.state || '',\n      postal_code: order.shipping_address.postal_code || '',\n      country: order.shipping_address.country || 'India'\n    }\n  }\n\n  // Handle case where billing address is stored as ID\n  if (order.billing_address_id) {\n    const billingResult = await sql<Address[]>`\n      SELECT id, address_line1, address_line2, city, state, postal_code, country\n      FROM addresses\n      WHERE id = ${order.billing_address_id}\n    `\n    billingAddress = billingResult?.[0] || null\n  }\n  // Handle case where billing address is stored as JSON\n  else if (order.shipping_address && order.billing_address_id === null) {\n    // For now, we'll assume billing address is the same as shipping if not explicitly set\n    billingAddress = shippingAddress\n  }\n\n  const orderItemsResult = await sql<OrderItem[]>`\n    SELECT \n      oi.id,\n      oi.product_id,\n      oi.quantity,\n      oi.product_price,\n      oi.product_name,\n      p.image_url\n    FROM order_items oi\n    LEFT JOIN products p ON oi.product_id = p.id\n    WHERE oi.order_id = ${Number.parseInt(id)}\n  `\n\n  const orderItems: OrderItem[] = orderItemsResult || []\n\n  const orderDate = new Date(order.created_at).toLocaleDateString(\"en-IN\", {\n    year: \"numeric\",\n    month: \"long\",\n    day: \"numeric\",\n  })\n\n  return (\n    <div className=\"container px-4 py-8\">\n      <div className=\"mb-6\">\n        <Link href=\"/admin/orders\">\n          <Button variant=\"outline\" className=\"cursor-pointer bg-transparent\">\n            ← Back to Orders\n          </Button>\n        </Link>\n      </div>\n\n      <div className=\"grid lg:grid-cols-3 gap-6\">\n        <div className=\"lg:col-span-2 space-y-6\">\n          {/* Order Header */}\n          <div className=\"bg-card border rounded-lg p-6\">\n            <div className=\"grid md:grid-cols-2 gap-4\">\n              <div>\n                <p className=\"text-sm text-muted-foreground mb-1\">Order Number</p>\n                <p className=\"text-lg font-semibold\">{order.order_number}</p>\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground mb-1\">Order Date</p>\n                <p className=\"text-lg\">{orderDate}</p>\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground mb-1\">Status</p>\n                <p className=\"text-lg capitalize font-medium\">{order.status}</p>\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground mb-1\">Payment Status</p>\n                <p className=\"text-lg capitalize font-medium\">{order.payment_status}</p>\n              </div>\n            </div>\n          </div>\n\n          {/* Cancel Order Button */}\n          {order.status !== \"cancelled\" && (order.status === \"pending\" || order.status === \"processing\") && (\n            <div className=\"bg-card border rounded-lg p-6\">\n              <h2 className=\"text-lg font-semibold mb-4\">Order Actions</h2>\n              <CancelOrderButton orderId={order.id} isAdmin={true} />\n            </div>\n          )}\n\n          {/* Customer Info */}\n          <div className=\"bg-card border rounded-lg p-6\">\n            <h2 className=\"text-lg font-semibold mb-4\">Customer Information</h2>\n            <div className=\"space-y-3\">\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Name</p>\n                <p className=\"font-medium\">{order.customer_name}</p>\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Email</p>\n                <p className=\"font-medium\">{order.customer_email}</p>\n              </div>\n              {order.customer_phone && (\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Phone</p>\n                  <p className=\"font-medium\">{order.customer_phone}</p>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Shipping Address */}\n          {shippingAddress && (\n            <div className=\"bg-card border rounded-lg p-6\">\n              <h2 className=\"text-lg font-semibold mb-4\">Shipping Address</h2>\n              <div className=\"space-y-2 text-sm\">\n                <p className=\"font-medium\">{shippingAddress.address_line1}</p>\n                {shippingAddress.address_line2 && <p>{shippingAddress.address_line2}</p>}\n                <p>\n                  {shippingAddress.city}, {shippingAddress.state} {shippingAddress.postal_code}\n                </p>\n                <p>{shippingAddress.country}</p>\n              </div>\n            </div>\n          )}\n\n          {/* Billing Address */}\n          {billingAddress && (\n            <div className=\"bg-card border rounded-lg p-6\">\n              <h2 className=\"text-lg font-semibold mb-4\">Billing Address</h2>\n              <div className=\"space-y-2 text-sm\">\n                <p className=\"font-medium\">{billingAddress.address_line1}</p>\n                {billingAddress.address_line2 && <p>{billingAddress.address_line2}</p>}\n                <p>\n                  {billingAddress.city}, {billingAddress.state} {billingAddress.postal_code}\n                </p>\n                <p>{billingAddress.country}</p>\n              </div>\n            </div>\n          )}\n\n          {/* Order Items */}\n          <div className=\"bg-card border rounded-lg p-6\">\n            <h2 className=\"text-lg font-semibold mb-4\">Items</h2>\n            <div className=\"space-y-4\">\n              {orderItems.length > 0 ? (\n                orderItems.map((item) => (\n                  <div key={item.id} className=\"flex gap-4 pb-4 border-b last:border-0 last:pb-0\">\n                    {item.image_url && (\n                      <Image\n                        src={item.image_url || \"/placeholder.svg\"}\n                        alt={item.product_name}\n                        width={64}\n                        height={64}\n                        className=\"w-16 h-16 object-cover rounded\"\n                        loading=\"lazy\"\n                      />\n                    )}\n                    <div className=\"flex-1\">\n                      <p className=\"font-medium\">{item.product_name}</p>\n                      <p className=\"text-sm text-muted-foreground\">Qty: {item.quantity}</p>\n                      <p className=\"font-medium\">₹{(Number(item.product_price) * item.quantity).toFixed(2)}</p>\n                    </div>\n                  </div>\n                ))\n              ) : (\n                <p className=\"text-muted-foreground\">No items found</p>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Order Summary */}\n        <div className=\"bg-card border rounded-lg p-6 h-fit sticky top-20\">\n          <h2 className=\"text-lg font-semibold mb-4\">Order Summary</h2>\n          <div className=\"space-y-3\">\n            <div className=\"flex justify-between\">\n              <span>Subtotal</span>\n              <span>₹{order.total_amount}</span>\n            </div>\n            <div className=\"flex justify-between\">\n              <span>Shipping</span>\n              <span className=\"text-green-600\">FREE</span>\n            </div>\n            <div className=\"flex justify-between text-lg font-semibold border-t pt-3\">\n              <span>Total</span>\n              <span>₹{order.total_amount}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAsCe,eAAe,iBAAiB,EAAE,MAAM,EAAuC;IAC5F,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;IAErB,MAAM,cAAc,MAAM,IAAA,6LAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,YAAY;IAE1C,IAAI,CAAC,OAAO;QACV,IAAA,oPAAQ,EAAC;IACX;IAEA,MAAM,OAAO,MAAM,IAAA,+KAAU,EAAC;IAC9B,IAAI,CAAC,QAAQ,KAAK,IAAI,KAAK,SAAS;QAClC,IAAA,oPAAQ,EAAC;IACX;IAEA,MAAM,cAAc,MAAM,mKAAG,AAAS,CAAC;;;;;;;;;;;;;;;;;;iBAkBxB,EAAE,OAAO,QAAQ,CAAC,IAAI;EACrC,CAAC;IAED,IAAI,CAAC,eAAe,YAAY,MAAM,KAAK,GAAG;QAC5C,IAAA,oPAAQ,EAAC;IACX;IAEA,MAAM,QAAQ,WAAW,CAAC,EAAE;IAE5B,IAAI,kBAAkC;IACtC,IAAI,iBAAiC;IAErC,qDAAqD;IACrD,IAAI,MAAM,mBAAmB,EAAE;QAC7B,MAAM,iBAAiB,MAAM,mKAAG,AAAW,CAAC;;;iBAG/B,EAAE,MAAM,mBAAmB,CAAC;IACzC,CAAC;QACD,kBAAkB,gBAAgB,CAAC,EAAE,IAAI;IAC3C,OAEK,IAAI,MAAM,gBAAgB,EAAE;QAC/B,kBAAkB;YAChB,IAAI;YACJ,eAAe,MAAM,gBAAgB,CAAC,aAAa,IAAI;YACvD,eAAe,MAAM,gBAAgB,CAAC,aAAa,IAAI;YACvD,MAAM,MAAM,gBAAgB,CAAC,IAAI,IAAI;YACrC,OAAO,MAAM,gBAAgB,CAAC,KAAK,IAAI;YACvC,aAAa,MAAM,gBAAgB,CAAC,WAAW,IAAI;YACnD,SAAS,MAAM,gBAAgB,CAAC,OAAO,IAAI;QAC7C;IACF;IAEA,oDAAoD;IACpD,IAAI,MAAM,kBAAkB,EAAE;QAC5B,MAAM,gBAAgB,MAAM,mKAAG,AAAW,CAAC;;;iBAG9B,EAAE,MAAM,kBAAkB,CAAC;IACxC,CAAC;QACD,iBAAiB,eAAe,CAAC,EAAE,IAAI;IACzC,OAEK,IAAI,MAAM,gBAAgB,IAAI,MAAM,kBAAkB,KAAK,MAAM;QACpE,sFAAsF;QACtF,iBAAiB;IACnB;IAEA,MAAM,mBAAmB,MAAM,mKAAG,AAAa,CAAC;;;;;;;;;;wBAU1B,EAAE,OAAO,QAAQ,CAAC,IAAI;EAC5C,CAAC;IAED,MAAM,aAA0B,oBAAoB,EAAE;IAEtD,MAAM,YAAY,IAAI,KAAK,MAAM,UAAU,EAAE,kBAAkB,CAAC,SAAS;QACvE,MAAM;QACN,OAAO;QACP,KAAK;IACP;IAEA,qBACE,iSAAC;QAAI,WAAU;;0BACb,iSAAC;gBAAI,WAAU;0BACb,cAAA,iSAAC,6OAAI;oBAAC,MAAK;8BACT,cAAA,iSAAC,wLAAM;wBAAC,SAAQ;wBAAU,WAAU;kCAAgC;;;;;;;;;;;;;;;;0BAMxE,iSAAC;gBAAI,WAAU;;kCACb,iSAAC;wBAAI,WAAU;;0CAEb,iSAAC;gCAAI,WAAU;0CACb,cAAA,iSAAC;oCAAI,WAAU;;sDACb,iSAAC;;8DACC,iSAAC;oDAAE,WAAU;8DAAqC;;;;;;8DAClD,iSAAC;oDAAE,WAAU;8DAAyB,MAAM,YAAY;;;;;;;;;;;;sDAE1D,iSAAC;;8DACC,iSAAC;oDAAE,WAAU;8DAAqC;;;;;;8DAClD,iSAAC;oDAAE,WAAU;8DAAW;;;;;;;;;;;;sDAE1B,iSAAC;;8DACC,iSAAC;oDAAE,WAAU;8DAAqC;;;;;;8DAClD,iSAAC;oDAAE,WAAU;8DAAkC,MAAM,MAAM;;;;;;;;;;;;sDAE7D,iSAAC;;8DACC,iSAAC;oDAAE,WAAU;8DAAqC;;;;;;8DAClD,iSAAC;oDAAE,WAAU;8DAAkC,MAAM,cAAc;;;;;;;;;;;;;;;;;;;;;;;4BAMxE,MAAM,MAAM,KAAK,eAAe,CAAC,MAAM,MAAM,KAAK,aAAa,MAAM,MAAM,KAAK,YAAY,mBAC3F,iSAAC;gCAAI,WAAU;;kDACb,iSAAC;wCAAG,WAAU;kDAA6B;;;;;;kDAC3C,iSAAC,gNAAiB;wCAAC,SAAS,MAAM,EAAE;wCAAE,SAAS;;;;;;;;;;;;0CAKnD,iSAAC;gCAAI,WAAU;;kDACb,iSAAC;wCAAG,WAAU;kDAA6B;;;;;;kDAC3C,iSAAC;wCAAI,WAAU;;0DACb,iSAAC;;kEACC,iSAAC;wDAAE,WAAU;kEAAgC;;;;;;kEAC7C,iSAAC;wDAAE,WAAU;kEAAe,MAAM,aAAa;;;;;;;;;;;;0DAEjD,iSAAC;;kEACC,iSAAC;wDAAE,WAAU;kEAAgC;;;;;;kEAC7C,iSAAC;wDAAE,WAAU;kEAAe,MAAM,cAAc;;;;;;;;;;;;4CAEjD,MAAM,cAAc,kBACnB,iSAAC;;kEACC,iSAAC;wDAAE,WAAU;kEAAgC;;;;;;kEAC7C,iSAAC;wDAAE,WAAU;kEAAe,MAAM,cAAc;;;;;;;;;;;;;;;;;;;;;;;;4BAOvD,iCACC,iSAAC;gCAAI,WAAU;;kDACb,iSAAC;wCAAG,WAAU;kDAA6B;;;;;;kDAC3C,iSAAC;wCAAI,WAAU;;0DACb,iSAAC;gDAAE,WAAU;0DAAe,gBAAgB,aAAa;;;;;;4CACxD,gBAAgB,aAAa,kBAAI,iSAAC;0DAAG,gBAAgB,aAAa;;;;;;0DACnE,iSAAC;;oDACE,gBAAgB,IAAI;oDAAC;oDAAG,gBAAgB,KAAK;oDAAC;oDAAE,gBAAgB,WAAW;;;;;;;0DAE9E,iSAAC;0DAAG,gBAAgB,OAAO;;;;;;;;;;;;;;;;;;4BAMhC,gCACC,iSAAC;gCAAI,WAAU;;kDACb,iSAAC;wCAAG,WAAU;kDAA6B;;;;;;kDAC3C,iSAAC;wCAAI,WAAU;;0DACb,iSAAC;gDAAE,WAAU;0DAAe,eAAe,aAAa;;;;;;4CACvD,eAAe,aAAa,kBAAI,iSAAC;0DAAG,eAAe,aAAa;;;;;;0DACjE,iSAAC;;oDACE,eAAe,IAAI;oDAAC;oDAAG,eAAe,KAAK;oDAAC;oDAAE,eAAe,WAAW;;;;;;;0DAE3E,iSAAC;0DAAG,eAAe,OAAO;;;;;;;;;;;;;;;;;;0CAMhC,iSAAC;gCAAI,WAAU;;kDACb,iSAAC;wCAAG,WAAU;kDAA6B;;;;;;kDAC3C,iSAAC;wCAAI,WAAU;kDACZ,WAAW,MAAM,GAAG,IACnB,WAAW,GAAG,CAAC,CAAC,qBACd,iSAAC;gDAAkB,WAAU;;oDAC1B,KAAK,SAAS,kBACb,iSAAC,2LAAK;wDACJ,KAAK,KAAK,SAAS,IAAI;wDACvB,KAAK,KAAK,YAAY;wDACtB,OAAO;wDACP,QAAQ;wDACR,WAAU;wDACV,SAAQ;;;;;;kEAGZ,iSAAC;wDAAI,WAAU;;0EACb,iSAAC;gEAAE,WAAU;0EAAe,KAAK,YAAY;;;;;;0EAC7C,iSAAC;gEAAE,WAAU;;oEAAgC;oEAAM,KAAK,QAAQ;;;;;;;0EAChE,iSAAC;gEAAE,WAAU;;oEAAc;oEAAE,CAAC,OAAO,KAAK,aAAa,IAAI,KAAK,QAAQ,EAAE,OAAO,CAAC;;;;;;;;;;;;;;+CAd5E,KAAK,EAAE;;;;sEAmBnB,iSAAC;4CAAE,WAAU;sDAAwB;;;;;;;;;;;;;;;;;;;;;;;kCAO7C,iSAAC;wBAAI,WAAU;;0CACb,iSAAC;gCAAG,WAAU;0CAA6B;;;;;;0CAC3C,iSAAC;gCAAI,WAAU;;kDACb,iSAAC;wCAAI,WAAU;;0DACb,iSAAC;0DAAK;;;;;;0DACN,iSAAC;;oDAAK;oDAAE,MAAM,YAAY;;;;;;;;;;;;;kDAE5B,iSAAC;wCAAI,WAAU;;0DACb,iSAAC;0DAAK;;;;;;0DACN,iSAAC;gDAAK,WAAU;0DAAiB;;;;;;;;;;;;kDAEnC,iSAAC;wCAAI,WAAU;;0DACb,iSAAC;0DAAK;;;;;;0DACN,iSAAC;;oDAAK;oDAAE,MAAM,YAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOxC"}}]
}