{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/Downloads/nivarasilverjewels/lib/db.ts"],"sourcesContent":["import { neon } from \"@neondatabase/serverless\"\n\n// Lazy initialization - only check for DATABASE_URL when it's actually used\nexport const sql = ((...args: any[]) => {\n  if (!process.env.DATABASE_URL) {\n    throw new Error(\"DATABASE_URL environment variable is not set\")\n  }\n  \n  const sqlInstance = neon(process.env.DATABASE_URL)\n  // @ts-ignore\n  return sqlInstance(...args)\n}) as ReturnType<typeof neon>"],"names":[],"mappings":";;;;AAAA;;AAGO,MAAM,MAAO,CAAC,GAAG;IACtB,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;QAC7B,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,cAAc,IAAA,iMAAI,EAAC,QAAQ,GAAG,CAAC,YAAY;IACjD,aAAa;IACb,OAAO,eAAe;AACxB"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/Downloads/nivarasilverjewels/app/actions/admin.ts"],"sourcesContent":["\"use server\"\n\nimport { cookies } from \"next/headers\"\nimport { revalidatePath } from \"next/cache\"\nimport { verifyAuth } from \"@/lib/session\"\nimport { sql } from \"@/lib/db\"\n\nexport async function updateOrderStatus(orderId: number, status: string) {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"session\")?.value\n\n  if (!token) {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  const user = await verifyAuth(token)\n  if (!user || user.role !== \"admin\") {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  try {\n    await sql`\n      UPDATE orders\n      SET status = ${status}, updated_at = CURRENT_TIMESTAMP\n      WHERE id = ${orderId}\n    `\n\n    revalidatePath(\"/admin/orders\")\n    return { success: true }\n  } catch (error) {\n    return { success: false, error: \"Failed to update order\" }\n  }\n}\n\nexport async function deleteProduct(productId: number) {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"session\")?.value\n\n  if (!token) {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  const user = await verifyAuth(token)\n  if (!user || user.role !== \"admin\") {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  try {\n    await sql`\n      DELETE FROM products\n      WHERE id = ${productId}\n    `\n\n    revalidatePath(\"/admin/products\")\n    revalidatePath(\"/shop\")\n    return { success: true }\n  } catch (error) {\n    return { success: false, error: \"Failed to delete product\" }\n  }\n}\n\nexport async function addProduct(data: any) {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"session\")?.value\n\n  if (!token) {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  const user = await verifyAuth(token)\n  if (!user || user.role !== \"admin\") {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  try {\n    const slug = data.name\n      .toLowerCase()\n      .replace(/[^a-z0-9]+/g, \"-\")\n      .replace(/(^-|-$)/g, \"\")\n\n    const imagesJson = JSON.stringify(Array.isArray(data.images) ? data.images : [data.image_url])\n\n    await sql`\n      INSERT INTO products (\n        name, slug, description, price, category_id, image_url, images, metal_purity, design_number\n      )\n      VALUES (\n        ${data.name}, ${slug}, ${data.description}, ${data.price}, \n        ${data.category_id}, ${data.image_url},\n        ${imagesJson}, ${data.metal_purity || null}, ${data.design_number || null}\n      )\n    `\n\n    revalidatePath(\"/admin/products\")\n    revalidatePath(\"/shop\")\n    return { success: true }\n  } catch (error) {\n    return { success: false, error: \"Failed to add product\" }\n  }\n}\n\nexport async function updateProduct(productId: number, data: any) {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"session\")?.value\n\n  if (!token) {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  const user = await verifyAuth(token)\n  if (!user || user.role !== \"admin\") {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  try {\n    const imagesJson = JSON.stringify(Array.isArray(data.images) ? data.images : [data.image_url])\n\n    await sql`\n      UPDATE products\n      SET \n        name = ${data.name},\n        description = ${data.description},\n        price = ${data.price},\n        category_id = ${data.category_id},\n        image_url = ${data.image_url},\n        images = ${imagesJson},\n        metal_purity = ${data.metal_purity || null},\n        design_number = ${data.design_number || null},\n        updated_at = CURRENT_TIMESTAMP\n      WHERE id = ${productId}\n    `\n\n    revalidatePath(\"/admin/products\")\n    revalidatePath(\"/shop\")\n    revalidatePath(`/products/${productId}`)\n    return { success: true }\n  } catch (error) {\n    return { success: false, error: \"Failed to update product\" }\n  }\n}\n\nexport async function addCategory(data: {\n  name: string\n  description: string\n  image_url: string\n  seo_title?: string\n  seo_description?: string\n}) {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"session\")?.value\n\n  if (!token) {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  const user = await verifyAuth(token)\n  if (!user || user.role !== \"admin\") {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  try {\n    const slug = data.name\n      .toLowerCase()\n      .replace(/[^a-z0-9]+/g, \"-\")\n      .replace(/(^-|-$)/g, \"\")\n\n    const seoTitle = data.seo_title || `${data.name} | NIVARA Jewellery`\n    const seoDescription = data.seo_description || data.description\n\n    await sql`\n      INSERT INTO categories (name, slug, description, image_url, meta_title, meta_description)\n      VALUES (${data.name}, ${slug}, ${data.description}, ${data.image_url}, ${seoTitle}, ${seoDescription})\n    `\n\n    revalidatePath(\"/admin/categories\")\n    revalidatePath(\"/shop\")\n    revalidatePath(\"/categories\")\n    return { success: true }\n  } catch (error) {\n    return { success: false, error: \"Failed to add category\" }\n  }\n}\n\nexport async function updateCategory(\n  categoryId: number,\n  data: { name: string; description: string; image_url: string; seo_title?: string; seo_description?: string },\n) {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"session\")?.value\n\n  if (!token) {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  const user = await verifyAuth(token)\n  if (!user || user.role !== \"admin\") {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  try {\n    const slug = data.name\n      .toLowerCase()\n      .replace(/[^a-z0-9]+/g, \"-\")\n      .replace(/(^-|-$)/g, \"\")\n\n    const seoTitle = data.seo_title || `${data.name} | NIVARA Jewellery`\n    const seoDescription = data.seo_description || data.description\n\n    await sql`\n      UPDATE categories\n      SET \n        name = ${data.name},\n        slug = ${slug},\n        description = ${data.description},\n        image_url = ${data.image_url},\n        meta_title = ${seoTitle},\n        meta_description = ${seoDescription}\n      WHERE id = ${categoryId}\n    `\n\n    revalidatePath(\"/admin/categories\")\n    revalidatePath(\"/shop\")\n    revalidatePath(`/categories/${slug}`)\n    return { success: true }\n  } catch (error) {\n    return { success: false, error: \"Failed to update category\" }\n  }\n}\n\nexport async function deleteCategory(categoryId: number) {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"session\")?.value\n\n  if (!token) {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  const user = await verifyAuth(token)\n  if (!user || user.role !== \"admin\") {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  try {\n    await sql`\n      DELETE FROM categories\n      WHERE id = ${categoryId}\n    `\n\n    revalidatePath(\"/admin/categories\")\n    revalidatePath(\"/shop\")\n    return { success: true }\n  } catch (error) {\n    return { success: false, error: \"Failed to delete category\" }\n  }\n}\n\nexport async function cancelOrder(orderId: number) {\n  const cookieStore = await cookies()\n  const token = cookieStore.get(\"session\")?.value\n\n  if (!token) {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  const user = await verifyAuth(token)\n  if (!user || user.role !== \"admin\") {\n    return { success: false, error: \"Unauthorized\" }\n  }\n\n  try {\n    // Check if order exists\n    const order = await sql`\n      SELECT * FROM orders WHERE id = ${orderId}\n    `\n\n    if (order.length === 0) {\n      return { success: false, error: \"Order not found\" }\n    }\n\n    // Only allow cancellation for pending or processing orders\n    if (![\"pending\", \"processing\"].includes(order[0].status)) {\n      return { success: false, error: \"Cannot cancel order in current status\" }\n    }\n\n    // Update order status\n    await sql`\n      UPDATE orders\n      SET status = 'cancelled'\n      WHERE id = ${orderId}\n    `\n\n    revalidatePath(\"/admin/orders\")\n    revalidatePath(`/admin/orders/${orderId}`)\n    return { success: true }\n  } catch (error) {\n    console.error(\"[v0] Cancel order error:\", error)\n    return { success: false, error: \"Failed to cancel order\" }\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 400, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/Downloads/nivarasilverjewels/.next-internal/server/app/admin/categories/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {addCategory as '401af00458668821159ce83d20fb6efe1fa1990eeb'} from 'ACTIONS_MODULE0'\nexport {updateCategory as '601bba83073285f4640e291c92ff5c39392c34bb05'} from 'ACTIONS_MODULE0'\nexport {deleteCategory as '403b9b633e848ed75ec8b22897970b99a1776b66e1'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}