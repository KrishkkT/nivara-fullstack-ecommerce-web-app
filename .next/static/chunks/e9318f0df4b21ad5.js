(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,r,a)=>{r.exports=e.r(76562)},95187,(e,r,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t={callServer:function(){return i.callServer},createServerReference:function(){return l.createServerReference},findSourceMapURL:function(){return d.findSourceMapURL}};for(var s in t)Object.defineProperty(a,s,{enumerable:!0,get:t[s]});let i=e.r(32120),d=e.r(92245),l=e.r(35326)},88844,e=>{"use strict";let r=(0,e.i(75254).default)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>r],88844)},41503,e=>{"use strict";var r=e.i(43476),a=e.i(71645),t=e.i(67881),s=e.i(95187),i=(0,s.createServerReference)("4068bf0181f24a199e2d852075c25992cf1639aea9",s.callServer,void 0,s.findSourceMapURL,"cancelOrder"),d=(0,s.createServerReference)("401afdf693e644ce4f0761bfd0af817d46732dc380",s.callServer,void 0,s.findSourceMapURL,"cancelOrder"),l=e.i(18566),n=e.i(20682);function c({orderId:e,isAdmin:s=!1}){let[c,o]=(0,a.useState)(!1),m=(0,l.useRouter)(),{toast:u}=(0,n.useToast)();async function p(){if(!confirm("Are you sure you want to cancel this order?"))return;o(!0);let r=s?await d(e):await i(e);o(!1),r.error?u({title:"Error",description:r.error,variant:"destructive"}):(u({title:"Order Cancelled",description:"Your order has been cancelled successfully. Refund will be processed within 5-7 working days."}),m.refresh())}return(0,r.jsx)(t.Button,{variant:"destructive",size:"sm",onClick:p,disabled:c,className:"w-full",children:c?"Cancelling...":"Cancel Order"})}e.s(["CancelOrderButton",()=>c],41503)},95468,e=>{"use strict";let r=(0,e.i(75254).default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["CheckCircle2",()=>r],95468)},51740,e=>{"use strict";var r=e.i(95187),a=(0,r.createServerReference)("00418ce438cb53ce0d5731b9ed91863489d3d34d38",r.callServer,void 0,r.findSourceMapURL,"getRazorpayPublicKey");e.s(["getRazorpayPublicKey",()=>a])},35177,e=>{"use strict";var r=e.i(43476),a=e.i(71645),t=e.i(18566),s=e.i(57688),i=e.i(22016),d=e.i(67881),l=e.i(47163),n=e.i(95468),c=e.i(75254);let o=(0,c.default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var m=e.i(88844);let u=(0,c.default)("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);var p=e.i(51740),y=e.i(41503);function h({order:e,items:c}){let h=(0,t.useRouter)(),[x,f]=(0,a.useState)(!1),[g,b]=(0,a.useState)(""),[j,v]=(0,a.useState)(!1),[N,w]=(0,a.useState)(!1);async function P(){if(!j)return void alert("Payment system is still loading. Please wait a moment and try again.");if(N)return void alert("Payment system failed to load. Please refresh the page and try again.");if(!g)return void alert("Payment system is loading. Please try again in a moment.");if(!window.Razorpay)return void alert("Payment gateway is not ready. Please refresh the page and try again.");f(!0);try{let r=await fetch("/api/razorpay/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number.parseFloat(e.total_amount),orderId:e.id})}),a=await r.json();if(!r.ok)throw Error(a.error||"Failed to create payment order");let t={key:g,amount:a.amount,currency:a.currency,name:"NIVARA",description:`Order ${e.order_number}`,order_id:a.id,handler:async r=>{try{let a=await fetch("/api/razorpay/verify-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_order_id:r.razorpay_order_id,razorpay_payment_id:r.razorpay_payment_id,razorpay_signature:r.razorpay_signature,orderId:e.id})});await a.json(),a.ok?(alert("Payment successful! Your order is being processed."),h.push("/orders"),h.refresh()):alert("Payment verification failed. Please contact support.")}catch(e){alert("Payment verification failed. Please contact support.")}finally{f(!1),document.body.style.overflow=""}},modal:{ondismiss:()=>{f(!1),document.body.style.overflow=""}},prefill:{name:e.shipping_address?.name||"",email:e.shipping_address?.email||""},theme:{color:"#B29789"}},s=new window.Razorpay(t);s.on("payment.failed",e=>{alert(`Payment failed: ${e.error.description}`),f(!1),document.body.style.overflow=""}),s.open()}catch(e){alert(e.message||"Payment failed. Please try again."),f(!1)}}(0,a.useEffect)(()=>{let e=document.createElement("script");return e.src="https://checkout.razorpay.com/v1/checkout.js",e.async=!0,e.onload=()=>{v(!0)},e.onerror=()=>{w(!0)},document.body.appendChild(e),(0,p.getRazorpayPublicKey)().then(e=>b(e)),()=>{document.body.contains(e)&&document.body.removeChild(e)}},[]);let _=e.shipping_address||{},k={pending:o,processing:m.Package,shipped:u,delivered:n.CheckCircle2,cancelled:o}[e.status]||o,S="cancelled"===e.status,R=!S&&"razorpay"===e.payment_type&&"awaiting_payment"===e.payment_status,C="shipped"===e.status||"delivered"===e.status;return(0,r.jsx)("div",{className:"container px-4 py-12",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto space-y-8",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-serif tracking-tight mb-2",children:"Order Details"}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:["Order #",e.order_number]}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Placed on"," ",new Date(e.created_at).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(k,{className:"h-5 w-5 text-primary"}),(0,r.jsx)("span",{className:"font-medium capitalize",children:e.status})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("span",{className:"text-xs px-3 py-1 rounded-full bg-blue-100 text-blue-800",children:"Online Payment"}),!S&&"paid"!==e.payment_status&&(0,r.jsx)("span",{className:"text-xs px-3 py-1 rounded-full bg-yellow-100 text-yellow-800",children:"awaiting_payment"===e.payment_status?"Pending Payment":e.payment_status}),"paid"===e.payment_status&&(0,r.jsx)("span",{className:"text-xs px-3 py-1 rounded-full bg-green-100 text-green-800",children:"Paid"})]})]})]}),S&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("strong",{children:"Your order has been cancelled."})," Refund will be processed within 5-7 working days."]})}),R&&(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-sm mb-3",children:"Complete your payment to process this order"}),(0,r.jsx)(d.Button,{onClick:P,disabled:x||!g||!j||N,children:x?"Processing...":"Pay Now"}),(N||!j)&&(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:N?"Payment system failed to load.":"Payment system is loading..."})]}),!S&&!C&&!R&&(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("strong",{children:"Shipping Information:"})," You will receive a shipping confirmation email at your registered email address once your order is shipped."]})}),!S&&("pending"===e.status||"processing"===e.status)&&(0,r.jsx)("div",{className:"bg-card border rounded-lg p-4",children:(0,r.jsx)(y.CancelOrderButton,{orderId:e.id})}),(0,r.jsxs)("div",{className:"bg-card border rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Items"}),(0,r.jsx)("div",{className:"space-y-4",children:c.map(e=>(0,r.jsxs)("div",{className:"flex gap-4 pb-4 border-b last:border-0 last:pb-0",children:[(0,r.jsx)(i.default,{href:`/products/${e.slug}`,className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"relative w-20 h-20 rounded-md overflow-hidden",children:(0,r.jsx)(s.default,{src:e.image_url||"/placeholder.svg",alt:e.product_name,fill:!0,className:"object-cover"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(i.default,{href:`/products/${e.slug}`,children:(0,r.jsx)("h3",{className:"font-medium hover:text-primary transition-colors",children:e.product_name})}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Quantity: ",e.quantity]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"font-semibold",children:(0,l.formatPrice)(Number.parseFloat(e.product_price))}),e.quantity>1&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(0,l.formatPrice)(Number.parseFloat(e.product_price)*e.quantity)," total"]})]})]},e.id))}),(0,r.jsxs)("div",{className:"pt-4 mt-4 border-t space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Subtotal"}),(0,r.jsx)("span",{children:(0,l.formatPrice)(Number.parseFloat(e.total_amount))})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Shipping"}),(0,r.jsx)("span",{className:"text-green-600",children:"FREE"})]}),(0,r.jsxs)("div",{className:"flex justify-between text-lg font-semibold pt-2",children:[(0,r.jsx)("span",{children:"Total"}),(0,r.jsx)("span",{children:(0,l.formatPrice)(Number.parseFloat(e.total_amount))})]})]})]}),_&&Object.keys(_).length>0&&(0,r.jsxs)("div",{className:"bg-card border rounded-lg p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Shipping Address"}),(0,r.jsxs)("div",{className:"text-sm space-y-1",children:[(0,r.jsx)("p",{children:_.address_line1||""}),_.address_line2&&(0,r.jsx)("p",{children:_.address_line2}),(0,r.jsxs)("p",{children:[_.city||"",", ",_.state||""," ",_.postal_code||""]}),(0,r.jsx)("p",{children:_.country||""})]})]})]})})}e.s(["OrderDetails",()=>h],35177)}]);