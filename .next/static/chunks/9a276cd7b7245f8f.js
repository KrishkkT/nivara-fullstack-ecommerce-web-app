(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,r,t)=>{r.exports=e.r(76562)},95187,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={callServer:function(){return i.callServer},createServerReference:function(){return o.createServerReference},findSourceMapURL:function(){return n.findSourceMapURL}};for(var s in a)Object.defineProperty(t,s,{enumerable:!0,get:a[s]});let i=e.r(32120),n=e.r(92245),o=e.r(35326)},23750,e=>{"use strict";var r=e.i(43476),t=e.i(47163);function a({className:e,type:a,...s}){return(0,r.jsx)("input",{type:a,"data-slot":"input",className:(0,t.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...s})}e.s(["Input",()=>a])},10708,e=>{"use strict";var r=e.i(43476),t=e.i(71645);e.i(74080);var a=e.i(91918),s=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let i=(0,a.createSlot)(`Primitive.${s}`),n=t.forwardRef((e,t)=>{let{asChild:a,...n}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,r.jsx)(a?i:s,{...n,ref:t})});return n.displayName=`Primitive.${s}`,{...e,[s]:n}},{}),i=t.forwardRef((e,t)=>(0,r.jsx)(s.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));i.displayName="Label";var n=e.i(47163);let o=t.forwardRef(({className:e,...t},a)=>(0,r.jsx)(i,{ref:a,className:(0,n.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...t}));o.displayName=i.displayName,e.s(["Label",()=>o],10708)},10772,e=>{"use strict";var r=e.i(71645),t=e.i(34620),a=r[" useId ".trim().toString()]||(()=>void 0),s=0;function i(e){let[i,n]=r.useState(a());return(0,t.useLayoutEffect)(()=>{e||n(e=>e??String(s++))},[e]),e||(i?`radix-${i}`:"")}e.s(["useId",()=>i])},86318,e=>{"use strict";var r=e.i(71645);e.i(43476);var t=r.createContext(void 0);function a(e){let a=r.useContext(t);return e||a||"ltr"}e.s(["useDirection",()=>a])},35804,99682,e=>{"use strict";var r=e.i(71645),t=e.i(34620);function a(e){let[a,s]=r.useState(void 0);return(0,t.useLayoutEffect)(()=>{if(e){s({width:e.offsetWidth,height:e.offsetHeight});let r=new ResizeObserver(r=>{let t,a;if(!Array.isArray(r)||!r.length)return;let i=r[0];if("borderBoxSize"in i){let e=i.borderBoxSize,r=Array.isArray(e)?e[0]:e;t=r.inlineSize,a=r.blockSize}else t=e.offsetWidth,a=e.offsetHeight;s({width:t,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}s(void 0)},[e]),a}function s(e){let t=r.useRef({value:e,previous:e});return r.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}e.s(["useSize",()=>a],35804),e.s(["usePrevious",()=>s],99682)},51740,e=>{"use strict";var r=e.i(95187),t=(0,r.createServerReference)("00418ce438cb53ce0d5731b9ed91863489d3d34d38",r.callServer,void 0,r.findSourceMapURL,"getRazorpayPublicKey");e.s(["getRazorpayPublicKey",()=>t])},37560,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(18566),s=e.i(67881),i=e.i(23750),n=e.i(10708),o=e.i(81140),d=e.i(20783),l=e.i(30030),c=e.i(48425),u=e.i(75830),p=e.i(10772),f=e.i(30207),m=e.i(69340),v=e.i(86318),y="rovingFocusGroup.onEntryFocus",h={bubbles:!1,cancelable:!0},x="RovingFocusGroup",[b,g,j]=(0,u.createCollection)(x),[w,R]=(0,l.createContextScope)(x,[j]),[N,S]=w(x),_=t.forwardRef((e,t)=>(0,r.jsx)(b.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,r.jsx)(b.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,r.jsx)(P,{...e,ref:t})})}));_.displayName=x;var P=t.forwardRef((e,a)=>{let{__scopeRovingFocusGroup:s,orientation:i,loop:n=!1,dir:l,currentTabStopId:u,defaultCurrentTabStopId:p,onCurrentTabStopIdChange:b,onEntryFocus:j,preventScrollOnEntryFocus:w=!1,...R}=e,S=t.useRef(null),_=(0,d.useComposedRefs)(a,S),P=(0,v.useDirection)(l),[C,I]=(0,m.useControllableState)({prop:u,defaultProp:p??null,onChange:b,caller:x}),[k,F]=t.useState(!1),L=(0,f.useCallbackRef)(j),A=g(s),z=t.useRef(!1),[D,T]=t.useState(0);return t.useEffect(()=>{let e=S.current;if(e)return e.addEventListener(y,L),()=>e.removeEventListener(y,L)},[L]),(0,r.jsx)(N,{scope:s,orientation:i,dir:P,loop:n,currentTabStopId:C,onItemFocus:t.useCallback(e=>I(e),[I]),onItemShiftTab:t.useCallback(()=>F(!0),[]),onFocusableItemAdd:t.useCallback(()=>T(e=>e+1),[]),onFocusableItemRemove:t.useCallback(()=>T(e=>e-1),[]),children:(0,r.jsx)(c.Primitive.div,{tabIndex:k||0===D?-1:0,"data-orientation":i,...R,ref:_,style:{outline:"none",...e.style},onMouseDown:(0,o.composeEventHandlers)(e.onMouseDown,()=>{z.current=!0}),onFocus:(0,o.composeEventHandlers)(e.onFocus,e=>{let r=!z.current;if(e.target===e.currentTarget&&r&&!k){let r=new CustomEvent(y,h);if(e.currentTarget.dispatchEvent(r),!r.defaultPrevented){let e=A().filter(e=>e.focusable);E([e.find(e=>e.active),e.find(e=>e.id===C),...e].filter(Boolean).map(e=>e.ref.current),w)}}z.current=!1}),onBlur:(0,o.composeEventHandlers)(e.onBlur,()=>F(!1))})})}),C="RovingFocusGroupItem",I=t.forwardRef((e,a)=>{let{__scopeRovingFocusGroup:s,focusable:i=!0,active:n=!1,tabStopId:d,children:l,...u}=e,f=(0,p.useId)(),m=d||f,v=S(C,s),y=v.currentTabStopId===m,h=g(s),{onFocusableItemAdd:x,onFocusableItemRemove:j,currentTabStopId:w}=v;return t.useEffect(()=>{if(i)return x(),()=>j()},[i,x,j]),(0,r.jsx)(b.ItemSlot,{scope:s,id:m,focusable:i,active:n,children:(0,r.jsx)(c.Primitive.span,{tabIndex:y?0:-1,"data-orientation":v.orientation,...u,ref:a,onMouseDown:(0,o.composeEventHandlers)(e.onMouseDown,e=>{i?v.onItemFocus(m):e.preventDefault()}),onFocus:(0,o.composeEventHandlers)(e.onFocus,()=>v.onItemFocus(m)),onKeyDown:(0,o.composeEventHandlers)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void v.onItemShiftTab();if(e.target!==e.currentTarget)return;let r=function(e,r,t){var a;let s=(a=e.key,"rtl"!==t?a:"ArrowLeft"===a?"ArrowRight":"ArrowRight"===a?"ArrowLeft":a);if(!("vertical"===r&&["ArrowLeft","ArrowRight"].includes(s))&&!("horizontal"===r&&["ArrowUp","ArrowDown"].includes(s)))return k[s]}(e,v.orientation,v.dir);if(void 0!==r){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let s=h().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===r)s.reverse();else if("prev"===r||"next"===r){var t,a;"prev"===r&&s.reverse();let i=s.indexOf(e.currentTarget);s=v.loop?(t=s,a=i+1,t.map((e,r)=>t[(a+r)%t.length])):s.slice(i+1)}setTimeout(()=>E(s))}}),children:"function"==typeof l?l({isCurrentTabStop:y,hasTabStop:null!=w}):l})})});I.displayName=C;var k={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function E(e,r=!1){let t=document.activeElement;for(let a of e)if(a===t||(a.focus({preventScroll:r}),document.activeElement!==t))return}var F=e.i(35804),L=e.i(99682),A=e.i(96626),z="Radio",[D,T]=(0,l.createContextScope)(z),[O,M]=D(z),H=t.forwardRef((e,a)=>{let{__scopeRadio:s,name:i,checked:n=!1,required:l,disabled:u,value:p="on",onCheck:f,form:m,...v}=e,[y,h]=t.useState(null),x=(0,d.useComposedRefs)(a,e=>h(e)),b=t.useRef(!1),g=!y||m||!!y.closest("form");return(0,r.jsxs)(O,{scope:s,checked:n,disabled:u,children:[(0,r.jsx)(c.Primitive.button,{type:"button",role:"radio","aria-checked":n,"data-state":B(n),"data-disabled":u?"":void 0,disabled:u,value:p,...v,ref:x,onClick:(0,o.composeEventHandlers)(e.onClick,e=>{n||f?.(),g&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})}),g&&(0,r.jsx)(q,{control:y,bubbles:!b.current,name:i,value:p,checked:n,required:l,disabled:u,form:m,style:{transform:"translateX(-100%)"}})]})});H.displayName=z;var K="RadioIndicator",U=t.forwardRef((e,t)=>{let{__scopeRadio:a,forceMount:s,...i}=e,n=M(K,a);return(0,r.jsx)(A.Presence,{present:s||n.checked,children:(0,r.jsx)(c.Primitive.span,{"data-state":B(n.checked),"data-disabled":n.disabled?"":void 0,...i,ref:t})})});U.displayName=K;var q=t.forwardRef(({__scopeRadio:e,control:a,checked:s,bubbles:i=!0,...n},o)=>{let l=t.useRef(null),u=(0,d.useComposedRefs)(l,o),p=(0,L.usePrevious)(s),f=(0,F.useSize)(a);return t.useEffect(()=>{let e=l.current;if(!e)return;let r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(p!==s&&r){let t=new Event("click",{bubbles:i});r.call(e,s),e.dispatchEvent(t)}},[p,s,i]),(0,r.jsx)(c.Primitive.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:u,style:{...n.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function B(e){return e?"checked":"unchecked"}q.displayName="RadioBubbleInput";var G=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],$="RadioGroup",[V,J]=(0,l.createContextScope)($,[R,T]),W=R(),X=T(),[Q,Y]=V($),Z=t.forwardRef((e,t)=>{let{__scopeRadioGroup:a,name:s,defaultValue:i,value:n,required:o=!1,disabled:d=!1,orientation:l,dir:u,loop:p=!0,onValueChange:f,...y}=e,h=W(a),x=(0,v.useDirection)(u),[b,g]=(0,m.useControllableState)({prop:n,defaultProp:i??null,onChange:f,caller:$});return(0,r.jsx)(Q,{scope:a,name:s,required:o,disabled:d,value:b,onValueChange:g,children:(0,r.jsx)(_,{asChild:!0,...h,orientation:l,dir:x,loop:p,children:(0,r.jsx)(c.Primitive.div,{role:"radiogroup","aria-required":o,"aria-orientation":l,"data-disabled":d?"":void 0,dir:x,...y,ref:t})})})});Z.displayName=$;var ee="RadioGroupItem",er=t.forwardRef((e,a)=>{let{__scopeRadioGroup:s,disabled:i,...n}=e,l=Y(ee,s),c=l.disabled||i,u=W(s),p=X(s),f=t.useRef(null),m=(0,d.useComposedRefs)(a,f),v=l.value===n.value,y=t.useRef(!1);return t.useEffect(()=>{let e=e=>{G.includes(e.key)&&(y.current=!0)},r=()=>y.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",r),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",r)}},[]),(0,r.jsx)(I,{asChild:!0,...u,focusable:!c,active:v,children:(0,r.jsx)(H,{disabled:c,required:l.required,checked:v,...p,...n,name:l.name,ref:m,onCheck:()=>l.onValueChange(n.value),onKeyDown:(0,o.composeEventHandlers)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,o.composeEventHandlers)(n.onFocus,()=>{y.current&&f.current?.click()})})})});er.displayName=ee;var et=t.forwardRef((e,t)=>{let{__scopeRadioGroup:a,...s}=e,i=X(a);return(0,r.jsx)(U,{...i,...s,ref:t})});et.displayName="RadioGroupIndicator";let ea=(0,e.i(75254).default)("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var es=e.i(47163);let ei=t.forwardRef(({className:e,...t},a)=>(0,r.jsx)(Z,{className:(0,es.cn)("grid gap-2",e),...t,ref:a}));ei.displayName=Z.displayName;let en=t.forwardRef(({className:e,...t},a)=>(0,r.jsx)(er,{ref:a,className:(0,es.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,r.jsx)(et,{className:"flex items-center justify-center",children:(0,r.jsx)(ea,{className:"h-2.5 w-2.5 fill-current text-current"})})}));en.displayName=er.displayName;var eo=e.i(95187),ed=(0,eo.createServerReference)("4092236c67afa3346a320374b8c3df1fa7187b9005",eo.callServer,void 0,eo.findSourceMapURL,"createOrder"),el=e.i(51740);function ec({user:e,addresses:o,cartItems:d,total:l}){let c=(0,a.useRouter)(),[u,p]=(0,t.useState)(!1),[f,m]=(0,t.useState)(o[0]?.id?.toString()||"new"),[v,y]=(0,t.useState)("razorpay"),[h,x]=(0,t.useState)(""),[b,g]=(0,t.useState)(!1),[j,w]=(0,t.useState)(!1);async function R(r,t){if(!b||!h||!window.Razorpay)return void alert("Payment system is not ready. Please try again.");p(!0);try{let a=await fetch("/api/razorpay/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:l,orderId:r})}),s=await a.json();if(!a.ok)throw Error(s.error||"Failed to create payment order");let i={key:h,amount:s.amount,currency:s.currency,name:"NIVARA",description:`Order ${t}`,order_id:s.id,handler:async e=>{try{let t=await fetch("/api/razorpay/verify-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_order_id:e.razorpay_order_id,razorpay_payment_id:e.razorpay_payment_id,razorpay_signature:e.razorpay_signature,orderId:r})});await t.json(),t.ok?(c.push(`/orders/${r}`),c.refresh()):alert("Payment verification failed. Please contact support.")}catch(e){alert("Payment verification failed. Please contact support.")}finally{p(!1)}},modal:{ondismiss:()=>{p(!1)}},prefill:{name:e.full_name,email:e.email},theme:{color:"#B29789"}},n=new window.Razorpay(i);n.on("payment.failed",e=>{alert(`Payment failed: ${e.error.description}`),p(!1)}),n.open()}catch(e){alert(e.message||"Payment failed. Please try again."),p(!1)}}async function N(e){let r;e.preventDefault(),p(!0);let t=new FormData(e.currentTarget),a=null;if("new"===f)r={address_line1:t.get("address_line1"),address_line2:t.get("address_line2"),city:t.get("city"),state:t.get("state"),postal_code:t.get("postal_code"),country:"India"};else{let e=o.find(e=>e.id.toString()===f);e&&(a=e.id,r={address_line1:e.address_line1,address_line2:e.address_line2,city:e.city,state:e.state,postal_code:e.postal_code,country:e.country})}let s=await ed({items:d.map(e=>({productId:e.product_id,quantity:e.quantity,price:Number.parseFloat(e.price)})),shippingAddress:r,shippingAddressId:a,paymentMethod:v,totalAmount:l});s.error?(alert(s.error),p(!1)):s.orderId&&s.orderNumber&&await R(s.orderId,s.orderNumber)}return(0,t.useEffect)(()=>{let e=document.createElement("script");return e.src="https://checkout.razorpay.com/v1/checkout.js",e.async=!0,e.onload=()=>{g(!0)},e.onerror=()=>{w(!0)},document.body.appendChild(e),(0,el.getRazorpayPublicKey)().then(e=>{x(e)}),()=>{document.body.contains(e)&&document.body.removeChild(e)}},[]),(0,r.jsxs)("form",{onSubmit:N,className:"space-y-8",children:[(0,r.jsxs)("div",{className:"bg-card border rounded-lg p-6 space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Contact Information"}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"name",children:"Full Name"}),(0,r.jsx)(i.Input,{id:"name",defaultValue:e.full_name,readOnly:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"email",children:"Email"}),(0,r.jsx)(i.Input,{id:"email",type:"email",defaultValue:e.email,readOnly:!0})]})]})]}),(0,r.jsxs)("div",{className:"bg-card border rounded-lg p-6 space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Shipping Address"}),o.length>0&&(0,r.jsxs)(ei,{value:f,onValueChange:m,children:[o.map(e=>(0,r.jsxs)("div",{className:"flex items-start space-x-2 border rounded p-3",children:[(0,r.jsx)(en,{value:e.id.toString(),id:`address-${e.id}`}),(0,r.jsxs)(n.Label,{htmlFor:`address-${e.id}`,className:"flex-1 cursor-pointer",children:[(0,r.jsx)("div",{className:"font-medium",children:e.address_line1}),e.address_line2&&(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:e.address_line2}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.city,", ",e.state," ",e.postal_code]}),e.is_default&&(0,r.jsx)("span",{className:"text-xs bg-primary/10 text-primary px-2 py-1 rounded mt-1 inline-block",children:"Default"})]})]},e.id)),(0,r.jsxs)("div",{className:"flex items-start space-x-2 border rounded p-3",children:[(0,r.jsx)(en,{value:"new",id:"address-new"}),(0,r.jsx)(n.Label,{htmlFor:"address-new",className:"cursor-pointer",children:"Use a new address"})]})]}),"new"===f&&(0,r.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"address_line1",children:"Address Line 1 *"}),(0,r.jsx)(i.Input,{id:"address_line1",name:"address_line1",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"address_line2",children:"Address Line 2"}),(0,r.jsx)(i.Input,{id:"address_line2",name:"address_line2"})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"city",children:"City *"}),(0,r.jsx)(i.Input,{id:"city",name:"city",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"state",children:"State *"}),(0,r.jsx)(i.Input,{id:"state",name:"state",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(n.Label,{htmlFor:"postal_code",children:"Postal Code *"}),(0,r.jsx)(i.Input,{id:"postal_code",name:"postal_code",required:!0})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-card border rounded-lg p-6 space-y-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Payment Method"}),(0,r.jsx)(ei,{value:v,onValueChange:y,children:(0,r.jsxs)("div",{className:"flex items-center space-x-2 border rounded p-3",children:[(0,r.jsx)(en,{value:"razorpay",id:"payment-razorpay"}),(0,r.jsxs)(n.Label,{htmlFor:"payment-razorpay",className:"flex-1 cursor-pointer",children:[(0,r.jsx)("div",{className:"font-medium",children:"Online"}),(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:"Secure online payment via Razorpay"})]})]})})]}),(0,r.jsx)(s.Button,{type:"submit",size:"lg",className:"w-full",disabled:u||!b||j,children:u?"Processing...":"Place Order"}),(j||!b)&&(0,r.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:j?"Payment system failed to load.":"Payment system is loading..."})]})}e.s(["CheckoutForm",()=>ec],37560)}]);